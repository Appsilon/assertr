---
output: html_document
---

```{r setup, include = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
library(htmltools)
library(assertr)
library(shiny)
library(shiny.semantic)
library(datavalidator)
```

<div id="report_header" style="margin: 2em;">
  <img src="logo.png" alt="logo" style="float: left; width: 25%; margin-right: 4em;"/>
  <h1>Data validation report</h1>
  <h4>`r format(Sys.time(), "%Y-%m-%d %H:%M:%S")`</h4>
</div>

```{r validator_init, message = FALSE, warning = FALSE}
validator <- Validator$new()
validator$repo_path <- params$repo_path
```

```{r scripts, message = FALSE, warning = FALSE}
for (script in params$scripts) {
  source(script, local = environment())
}
```

```{r report_generation}
validator$generate_html_report()

tags$script("
  function classToggle(object) {
      object.classList.toggle('active');
      object.nextElementSibling.classList.toggle('active');
  }
")
```
