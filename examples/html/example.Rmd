---
output: 
  html_document:
    extra_dependencies: !expr list(dataval_deps)
---

```{r setup, include = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
library(dplyr)
library(tidyr)
library(htmltools)
library(assertr)
library(shiny)
library(shiny.semantic)
library(datavalidator)
```

<script class = "testjs" src="`r system.file('www/shared/semantic/semantic.min.js', package = 'shiny.semantic')`"></script>
<div id="report_header" style="margin: 2em;">
  <img src="logo.png" alt="logo" style="float: left; width: 25%; margin-right: 4em;"/>
  <h1>Data validation report</h1>
  <h4>`r format(Sys.time(), "%Y-%m-%d %H:%M:%S")`</h4>
</div>

```{r validator_init, message = FALSE, warning = FALSE}
validator <- Validator$new()
```

```{r scripts, message = FALSE, warning = FALSE}
for (script in params$scripts) {
  source(script, local = environment())
}
```

```{r report_generation}
validator$generate_html_report()
```
